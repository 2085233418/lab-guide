# 前言

欢迎来到 **ErrorOS 实验指导书**！

操作系统是计算机科学中最核心、最富挑战性的领域之一。它像一位幕后指挥家，协调着硬件资源，为上层应用提供统一的接口。然而，操作系统的学习往往让人望而却步——概念抽象、实现复杂、调试困难。

**我们相信：最好的学习方式就是动手实践。**

本指导书采用"手把手教学"的方式，带领你从零开始，用现代化的 **Rust 语言**，在 **RISC-V 架构**上构建一个功能完整的操作系统——**ErrorOS**。

---

## 为什么是 ErrorOS？

**Error** 在英文中意为"错误"，这个名字蕴含着我们的教学理念：

> **在错误中学习，在调试中成长。**

编写操作系统的过程必然充满挑战和错误。当你看到内核 panic、地址错误、页表配置失败时，不要气馁——这正是深入理解底层机制的最佳时机。ErrorOS 的每一行代码、每一个设计决策，都经过精心打磨，帮助你在遇到错误时快速定位问题、理解原理。

---

## 你将学到什么？

通过本指导书的学习，你将：

###  理论知识
- **RISC-V 架构**：特权级模式、CSR 寄存器、中断/异常处理机制
- **内存管理**：物理内存分配、虚拟内存映射、页表机制
- **进程管理**：PCB 设计、上下文切换、进程调度算法
- **文件系统**：VFS 抽象、Inode 设计、文件描述符表
- **系统调用**：用户态与内核态切换、系统调用分发

### 🛠️ 实践能力
- **Rust 系统编程**：裸机编程、内联汇编、unsafe 代码
- **调试技巧**：QEMU 调试、日志输出、内存布局分析
- **工程能力**：模块化设计、错误处理、测试驱动开发

### 💡 设计思维
- **为什么要虚拟内存？** 解决碎片化、隔离、地址冲突
- **为什么要系统调用？** 保护内核、资源管理、统一接口
- **如何权衡设计？** 性能 vs 安全性、简单 vs 灵活性

---

## 本书特色

### 1. 渐进式学习路径
从最基础的环境配置，到复杂的文件系统实现，每一步都有清晰的指引。你不需要提前掌握所有知识，跟着教程一步步走即可。

### 2. 理论与实践结合
每个章节都先解释"为什么"，再讲"怎么做"。我们不仅教你写代码，更重要的是理解背后的原理和设计思想。

### 3. 图文并茂
配有大量技术图示：内存布局图、状态转换图、系统调用流程图等，帮助你建立直观认知。

### 4. 代码注释详尽
每段代码都有逐行解释，关键部分会深入讲解。你可以边读边写，边调试边理解。

### 5. 现代化技术栈
- **Rust 语言**：内存安全、零成本抽象、强大的类型系统
- **RISC-V 架构**：简洁优雅、开源开放、学术界和工业界的新宠
- **QEMU 模拟器**：无需真实硬件，即可运行和调试

---

## 如何使用本指导书？

### 适用对象
- 正在学习操作系统课程的学生
- 对底层系统编程感兴趣的开发者
- 想要学习 RISC-V 架构和 Rust 语言的工程师
- 希望深入理解计算机工作原理的爱好者

### 前置知识
- **必需**：基本的编程能力（任何语言均可）
- **推荐**：对 C 语言或 Rust 有一定了解
- **加分**：学过计算机组成原理、数据结构等课程

### 学习建议
1. **按序学习**：章节之间有依赖关系，请从第 0 章开始
2. **动手实践**：每读完一节，立即动手实现
3. **理解原理**：遇到问题时，先思考"为什么"再查资料
4. **做好笔记**：记录关键概念和调试技巧
5. **循序渐进**：操作系统很复杂，慢慢来反而更快

---

## 章节概览

本指导书共分为 **8 章**，涵盖从环境搭建到文件系统的完整实现：

| 章节 | 标题 | 核心内容 |
|------|------|----------|
| 第 0 章 | 环境配置 | Rust 工具链、QEMU 安装、项目初始化 |
| 第 1 章 | 最小内核 | 裸机编程、UART 驱动、第一个输出 |
| 第 2 章 | 异常与中断 | RISC-V 特权级、异常处理、中断分发 |
| 第 3 章 | 物理内存管理 | 页帧分配器、堆分配器、动态内存 |
| 第 4 章 | 虚拟内存管理 | 页表机制、地址映射、MMU 配置 |
| 第 5 章 | 系统调用 | `ecall` 指令、系统调用分发、用户态切换 |
| 第 6 章 | 进程管理 | PCB 设计、上下文切换、进程调度、fork/exec |
| 第 7 章 | 文件系统 | VFS 抽象、Inode 设计、文件系统调用 |

---

## 致谢

本指导书的编写受到了众多优秀开源项目的启发：
- **rCore-Tutorial**：清华大学的 RISC-V 操作系统教程
- **Blog OS**：Philipp Oppermann 的 Rust x86_64 操作系统教程
- **xv6-riscv**：MIT 6.S081 课程的经典教学操作系统

感谢 Rust 社区和 RISC-V 社区的无私贡献，让我们能够站在巨人的肩膀上学习。

---

## 开始你的操作系统之旅吧！

准备好了吗？让我们从第 0 章开始，搭建开发环境，迈出构建 ErrorOS 的第一步！

**记住：每一个错误都是进步的阶梯，每一次调试都是深入理解的机会。**

祝你学习愉快！

---

<div align="right">
<i>ErrorOS 开发团队</i><br>
</div>
